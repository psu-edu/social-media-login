<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Social Media Login</title>
    <link rel="stylesheet" href="stylesheet.css" type="text/css" />
</head>
<body>
  
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v22.0&appId=1837823793446991"></script>

    <!-- provided by Facebook - JavaScript SDK-->
     <!-- Set the element id for the JSON response -->
      <p id="profile"></p>

      <!-- include google SDK securely -->
      <script src="https://accounts.google.com/gsi/client" async defer></script>

      <!-- include Facebook SDK securely -->
      <script async defer crossorigin="anonymous">
        // This is called with the results from from FB.getLoginStatus().
        function statusChangeCallback(response) {
          console.log('statusChangeCallback');
          console.log(response);
          // The response object is returned with a status field that lets the app know the current login status of the person.
          // Full docs on the response object can be found in the documentation for FB.getLoginStatus().
          if (response.status === 'connected') {
            // Logged into your app and Facebook.
            testAPI();
          } else {
            // The person is not logged into your app or we are unable to tell.
            document.getElementById('status').innerHTML = 'Please log ' + 'into this app.';
          }
        }

        // This function is called when someone finishes with the Login Button.  
        // See the onlogin handler attached to it in the sample code below.
        function checkLoginState() {
          FB.getLoginStatus(function(response) {
            statusChangeCallback(response);
          });
        }

        window.fbAsyncInit = function() {
          FB.init({
            appId      : '1837823793446991',
            xfbml      : true,
            version    : 'v22.0'
          });
          FB.AppEvents.logPageView();
        };

        // Now that we've initialized the JavaScript SDK, we call FB.getLoginStatus().  This function gets the state of the
        // person visiting this page and can return one of three states to the callback you provide.  They can be:
        // 1. Logged into your app ('connected')
        // 2. Logged into Facebook, but not your app ('not_authorized')
        // 3. Not logged into Facebook and can't tell if they are logged into your app or not.
        // These three cases are handled in the callback function.
        FB.getLoginStatus(function(response) {
          statusChangeCallback(response);
        });

        // Load the SDK asynchronously
        (function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          //may need to update this url to be specific to web app as this src url is from the example given
          js.src = "https://connect.facebook.net/en_US/sdk.js";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

        // Here we run a very simple test of the Graph API after login is successful.  See statusChangeCallback() for when this call is made.
        function testAPI() {
          console.log('Welcome!  Fetching your information.... ');
          FB.api('/me', function(response) {
            console.log('Successful login for: ' + response.name);
            ocument.getElementById('status').innerHTML ='Thanks for logging in, ' + response.name + '!';
          });
        }

        //Implement CSRF protection by using the state parameter in the OAuth flow
        const state = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        sessionStorage.setItem('oauth_state', state);
        // When the user clicks the login button, redirect them to the Google OAuth 2.0 authorization endpoint
        const redirectUri = 'https://vigilant-barnacle-nr32lo5.pages.github.io/callback.html';
        window.location.href = `https://accounts.google.com/o/oauth2/auth?client_id=805207106585-cfonbclil4523d7q44f1f9g0dlslgr3u.apps.googleusercontent.com&redirect_uri=${redirectUri}&scope=email%20profile&response_type=code&state=${state}`;

        // If you are logged in, automatically get your name and email adress, your public profile information
        FB.login(function(response) {
                  if (response.authResponse) {
                       console.log('Welcome!  Fetching your information.... ');
                       FB.api('/me', {fields: 'name, email'}, function(response) {
                           document.getElementById("profile").innerHTML = "Good to see you, " + response.name + ". i see your email address is " + response.email
                       });
                  } else {
                       // If you are not logged in, the login dialog will open for you to login asking for permission to get your public profile and email
                       console.log('User cancelled login or did not fully authorize.'); }
        });
      </script>

<h1>Login Options</h1>
<p><em>Click below to login using an existing social media account:</em></p>

<div style="display: flex; align-items: flex-start; gap: 20px;">
  <div>
    <div class="fb-login-button" data-width="" data-size="" data-button-type="" data-layout="" data-auto-logout-link="true" data-use-continue-as="false">

      <p>Login with Facebook</p>

      <!--
      Login Button social plugin provided by FB. This button uses the JavaScript SDK 
      to present a graphical Login button that triggers the FB.login() function when clicked.
      -->
        <!-- 
        Started with this button but may want to remove in place of FB login button provided by Facebook in the SDK
        <button onclick="FB.login();">Login with Facebook</button> 
        -->
        <fb:login-button scope="public_profile,email" onlogin="checkLoginState();">

        </fb:login-button>
    </div>
  </div>

  <div>
    <p>Or login with Google</p>
    <button onclick="window.location.href='https://accounts.google.com/o/oauth2/auth?client_id=YOUR_CLIENT_ID&redirect_uri=YOUR_REDIRECT_URI&scope=email%20profile&response_type=code'">Login with Google</button>
  </div>
</div>

<h2>Documentation</h2>
    <p>This page demonstrates how to implement social media login using Facebook and Google. The Facebook SDK is used to handle the login process, while a simple button is provided for Google login.</p>
    <div style="display: flex; align-items: center; gap: 40px;">
      <div>
        <p>For more information, visit the <a href="https://developers.facebook.com/docs/facebook-login/web">Facebook Login documentation</a>.</p>
        <img src="https://www.facebook.com/images/fb_icon_325x325.png" alt="Facebook Logo" class="resizable-image">
      </div>
      <div>
        <p>For Google login, refer to the <a href="https://developers.google.com/identity/sign-in/web/sign-in">Google Sign-In documentation</a>.</p>
        <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" alt="Google Logo" class="resizable-image">
      </div>
    </div>

  </body>
</html>